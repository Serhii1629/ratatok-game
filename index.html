<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ğ Ğ°Ñ‚Ğ°Ñ‚Ğ¾Ğº</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #121212;
    color: white;
    text-align: center;
}

header {
    font-size: 24px;
    padding: 15px;
    background: #1f1f1f;
}

#rat {
    font-size: 110px;
    margin: 20px 0;
    user-select: none;
}

.stats {
    font-size: 18px;
}

.menu {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: #1f1f1f;
    display: flex;
    justify-content: space-around;
    padding: 15px 0;
    font-size: 18px;
}

button {
    font-size: 18px;
    padding: 12px 18px;
    margin: 5px;
}

.panel {
    display: none;
    padding-bottom: 90px;
}
.panel.active {
    display: block;
}
</style>
</head>

<body>

<header>ğŸ­ Ğ Ğ°Ñ‚Ğ°Ñ‚Ğ¾Ğº</header>

<div id="game" class="panel active">
    <div id="rat">ğŸ€</div>
    <div class="stats">
        Ğ¢Ğ°Ğ¿Ñ‹: <span id="score">0</span><br>
        Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ: <span id="energy">100</span>/100<br>
        ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸ĞºĞµÑ€: <span id="auto">0</span>
    </div>
</div>

<div id="shop" class="panel">
    <h2>ğŸ›’ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</h2>
    <button onclick="buyAuto()">ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸ĞºĞµÑ€ (+1)</button><br>
    <button onclick="buyEnergy()">Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ +50</button>
</div>

<div id="cards" class="panel">
    <h2>ğŸƒ ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸</h2>
    <div id="cardList"></div>
</div>

<div id="ref" class="panel">
    <h2>ğŸ”— Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ĞºĞ°</h2>
    <p>Ğ¢Ğ²Ğ¾Ñ ÑÑÑ‹Ğ»ĞºĞ°:</p>
    <p id="refLink"></p>
</div>

<div class="menu">
    <div onclick="openPanel('game')">ğŸ®</div>
    <div onclick="openPanel('shop')">ğŸ›’</div>
    <div onclick="openPanel('cards')">ğŸƒ</div>
    <div onclick="openPanel('ref')">ğŸ”—</div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// ===== Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• =====
let score = Number(localStorage.getItem("score")) || 0;
let energy = Number(localStorage.getItem("energy")) || 100;
let auto = Number(localStorage.getItem("auto")) || 0;
let power = Number(localStorage.getItem("power")) || 1;

// ===== ĞšĞ Ğ«Ğ¡Ğ« ĞŸĞ Ğ£Ğ ĞĞ’ĞĞ¯Ğœ =====
const rats = [
    { taps: 0, icon: "ğŸ€" },
    { taps: 500, icon: "ğŸ" },
    { taps: 2000, icon: "ğŸ­" },
    { taps: 5000, icon: "ğŸ¹" },
    { taps: 15000, icon: "ğŸ‘‘ğŸ­" }
];

// ===== ĞšĞĞ Ğ¢ĞĞ§ĞšĞ˜ =====
const cards = Array.from({ length: 20 }, (_, i) => ({
    id: i,
    price: (i + 1) * 100,
    bonus: i + 1,
    bought: false
}));

// ===== Ğ­Ğ›Ğ•ĞœĞ•ĞĞ¢Ğ« =====
const scoreEl = document.getElementById("score");
const energyEl = document.getElementById("energy");
const autoEl = document.getElementById("auto");
const ratEl = document.getElementById("rat");
const cardList = document.getElementById("cardList");

// ===== Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜ =====
function save() {
    localStorage.setItem("score", score);
    localStorage.setItem("energy", energy);
    localStorage.setItem("auto", auto);
    localStorage.setItem("power", power);
}

function updateUI() {
    scoreEl.textContent = score;
    energyEl.textContent = energy;
    autoEl.textContent = auto;

    let currentRat = rats[0].icon;
    rats.forEach(r => {
        if (score >= r.taps) currentRat = r.icon;
    });
    ratEl.textContent = currentRat;
}

ratEl.onclick = () => {
    if (energy <= 0) return;
    score += power;
    energy -= 1;
    updateUI();
    save();
};

// ===== ĞĞ’Ğ¢ĞĞšĞ›Ğ˜ĞšĞ•Ğ  =====
setInterval(() => {
    if (auto > 0 && energy > 0) {
        score += auto;
        energy -= auto;
        updateUI();
        save();
    }
}, 1000);

// ===== ĞœĞĞ“ĞĞ—Ğ˜Ğ =====
function buyAuto() {
    if (score >= 200) {
        score -= 200;
        auto += 1;
        updateUI();
        save();
    }
}

function buyEnergy() {
    if (score >= 100) {
        score -= 100;
        energy += 50;
        if (energy > 100) energy = 100;
        updateUI();
        save();
    }
}

// ===== ĞšĞĞ Ğ¢ĞĞ§ĞšĞ˜ =====
cards.forEach(card => {
    const btn = document.createElement("button");
    btn.textContent = `ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ° +${card.bonus} (${card.price})`;
    btn.onclick = () => {
        if (!card.bought && score >= card.price) {
            score -= card.price;
            power += card.bonus;
            card.bought = true;
            btn.disabled = true;
            btn.textContent += " âœ…";
            updateUI();
            save();
        }
    };
    cardList.appendChild(btn);
});

// ===== Ğ Ğ•Ğ¤Ğ•Ğ ĞĞ› =====
const refLink = `https://t.me/${tg.initDataUnsafe.user?.username}?start=ref_${tg.initDataUnsafe.user?.id}`;
document.getElementById("refLink").textContent = refLink;

// ===== ĞœĞ•ĞĞ® =====
function openPanel(id) {
    document.querySelectorAll(".panel").forEach(p => p.classList.remove("active"));
    document.getElementById(id).classList.add("active");
}

updateUI();
</script>

</body>
</html>
