<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RATATOK</title>

<style>
body{margin:0;font-family:Arial;background:#0b0b0f;color:#fff}
#top{display:flex;justify-content:space-around;padding:10px;background:#111}
#tapArea{display:flex;justify-content:center;align-items:center;height:45vh}
#rat{font-size:120px;cursor:pointer;user-select:none}
#menu{position:fixed;bottom:0;width:100%;display:flex}
button{flex:1;padding:14px;border:none;background:#1c1c28;color:#fff}
.panel{display:none;position:fixed;bottom:52px;width:100%;max-height:50vh;overflow:auto;background:#14141c;padding:10px}
.card{background:#1e1e2c;padding:10px;border-radius:10px;margin-bottom:8px}
.card button{width:100%;margin-top:6px}
</style>
</head>

<body>

<div id="top">
  <div>ğŸ’° <span id="coins">0</span></div>
  <div>âš¡ <span id="energy">100</span></div>
  <div>â­ <span id="level">1</span></div>
</div>

<div id="tapArea">
  <div id="rat">ğŸ­</div>
</div>

<div id="shop" class="panel">
  <h3>ğŸ›’ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</h3>
  <div id="shopItems"></div>
</div>

<div id="cards" class="panel">
  <h3>ğŸƒ ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸</h3>
  <div id="cardItems"></div>
</div>

<div id="ref" class="panel">
  <h3>ğŸ”— Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ°</h3>
  <input id="refLink" style="width:100%;padding:6px" readonly>
</div>

<div id="menu">
  <button onclick="hide()">ğŸ®</button>
  <button onclick="show('shop')">ğŸ›’</button>
  <button onclick="show('cards')">ğŸƒ</button>
  <button onclick="show('ref')">ğŸ”—</button>
</div>

<script>
// ---------- ĞšĞ Ğ«Ğ¡Ğ« ĞŸĞ Ğ£Ğ ĞĞ’ĞĞ¯Ğœ ----------
const RATS = [
 {lvl:1, icon:"ğŸ­"},
 {lvl:2, icon:"ğŸ€"},
 {lvl:3, icon:"ğŸ–¤"},
 {lvl:4, icon:"ğŸ‘¹"},
 {lvl:5, icon:"ğŸ‘‘"}
];

// ---------- ĞšĞĞ Ğ¢ĞĞ§ĞšĞ˜ ----------
const CARDS = [
 {id:1,name:"+1 Ğ·Ğ° Ñ‚Ğ°Ğ¿",tap:1,price:50},
 {id:2,name:"+3 Ğ·Ğ° Ñ‚Ğ°Ğ¿",tap:3,price:200},
 {id:3,name:"+1 Ğ°Ğ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº",auto:1,price:300},
 {id:4,name:"+5 Ğ°Ğ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº",auto:5,price:1200},
 {id:5,name:"+20 Ğ°Ğ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº",auto:20,price:5000}
];

// ---------- ĞœĞĞ“ĞĞ—Ğ˜Ğ ----------
const SHOP = [
 {id:1,name:"Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ +50",energy:50,price:30}
];

// ---------- Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• ----------
let state = JSON.parse(localStorage.getItem("ratatok")) || {
 coins:0,
 energy:100,
 tap:1,
 auto:0,
 level:1,
 taps:0,
 cards:{}
};

// ---------- UI ----------
const coinsEl=coins, energyEl=energy, levelEl=level, ratEl=rat;

function updateUI(){
 coinsEl.textContent = state.coins;
 energyEl.textContent = state.energy;
 levelEl.textContent = state.level;

 let rat = RATS[Math.min(state.level-1, RATS.length-1)];
 ratEl.textContent = rat.icon;

 localStorage.setItem("ratatok",JSON.stringify(state));
}

// ---------- Ğ¢ĞĞŸ ----------
ratEl.onclick = ()=>{
 if(state.energy<=0) return;
 state.energy--;
 state.coins += state.tap;
 state.taps++;

 if(state.taps >= state.level*100){
   state.level++;
 }

 updateUI();
};

// ---------- ĞĞ’Ğ¢ĞĞšĞ›Ğ˜Ğš ----------
setInterval(()=>{
 if(state.auto>0){
   state.coins += state.auto;
   updateUI();
 }
},1000);

// ---------- ĞœĞĞ“ĞĞ—Ğ˜Ğ ----------
function renderShop(){
 shopItems.innerHTML="";
 SHOP.forEach(i=>{
  shopItems.innerHTML+=`
   <div class="card">
    ${i.name}<br>
    Ğ¦ĞµĞ½Ğ°: ${i.price}
    <button onclick="buyShop(${i.id})">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
   </div>`;
 });
}
function buyShop(id){
 let i=SHOP.find(x=>x.id===id);
 if(state.coins<i.price) return;
 state.coins-=i.price;
 state.energy+=i.energy;
 updateUI();
}

// ---------- ĞšĞĞ Ğ¢ĞĞ§ĞšĞ˜ ----------
function renderCards(){
 cardItems.innerHTML="";
 CARDS.forEach(c=>{
  let lvl=state.cards[c.id]||0;
  let price=c.price*(lvl+1);
  cardItems.innerHTML+=`
   <div class="card">
    ${c.name} (ÑƒÑ€ ${lvl})<br>
    Ğ¦ĞµĞ½Ğ°: ${price}
    <button onclick="buyCard(${c.id})">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
   </div>`;
 });
}
function buyCard(id){
 let c=CARDS.find(x=>x.id===id);
 let lvl=state.cards[id]||0;
 let price=c.price*(lvl+1);
 if(state.coins<price) return;

 state.coins-=price;
 state.cards[id]=lvl+1;
 if(c.tap) state.tap+=c.tap;
 if(c.auto) state.auto+=c.auto;

 renderCards();
 updateUI();
}

// ---------- Ğ Ğ•Ğ¤ Ğ¡Ğ¡Ğ«Ğ›ĞšĞ ----------
function initRef(){
 let id=localStorage.getItem("refid");
 if(!id){
   id=Math.random().toString(36).substr(2,8);
   localStorage.setItem("refid",id);
 }
 refLink.value=location.origin+location.pathname+"?ref="+id;
}

// ---------- ĞŸĞĞĞ•Ğ›Ğ˜ ----------
function show(id){hide();document.getElementById(id).style.display="block"}
function hide(){document.querySelectorAll(".panel").forEach(p=>p.style.display="none")}

renderShop();
renderCards();
initRef();
updateUI();
</script>

</body>
</html>
