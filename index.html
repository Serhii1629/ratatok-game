<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RATATOK</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#0b0b0f;
  color:#fff;
  font-family:Arial,sans-serif;
}
#top{
  display:flex;
  justify-content:space-around;
  padding:10px;
  background:#111;
  font-size:14px;
}
#tapArea{
  height:42vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
#ratBtn{
  width:260px;
  height:260px;
  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;
  background-color:transparent;
  border:none;
  transition:transform .08s;
}
#ratBtn:active{transform:scale(1.12)}

#menu{
  position:fixed;
  bottom:0;
  width:100%;
  display:flex;
}
#menu button{
  flex:1;
  padding:12px;
  background:#1c1c28;
  color:#fff;
  border:none;
}

.panel{
  display:none;
  position:fixed;
  bottom:48px;
  width:100%;
  max-height:50vh;
  overflow:auto;
  background:#14141c;
  padding:10px;
}
.card{
  background:#1e1e2c;
  padding:10px;
  border-radius:10px;
  margin-bottom:8px;
}
</style>
</head>

<body>

<div id="top">
  <div>ğŸ’° <span id="coins">0</span></div>
  <div>âš¡ <span id="energy">100</span></div>
  <div>â­ <span id="level">1</span></div>
</div>

<div id="tapArea">
  <button id="ratBtn"></button>
</div>

<div id="shop" class="panel">
  <h3>ğŸ›’ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</h3>
  <div id="shopItems"></div>
</div>

<div id="cards" class="panel">
  <h3>ğŸƒ ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸</h3>
  <div id="cardItems"></div>
</div>

<div id="nft" class="panel">
  <h3>ğŸ–¼ NFT ĞºÑ€Ñ‹ÑÑ‹ (DEMO)</h3>
  <div id="nftItems"></div>
</div>

<div id="airdrop" class="panel">
  <h3>ğŸ ĞĞ¸Ñ€Ğ´Ñ€Ğ¾Ğ¿ (DEMO)</h3>
  <button onclick="claimAirdrop()">ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ 500 Ğ¼Ğ¾Ğ½ĞµÑ‚</button>
</div>

<div id="ref" class="panel">
  <h3>ğŸ”— Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»</h3>
  <p id="refLink"></p>
</div>

<div id="menu">
  <button onclick="hide()">ğŸ® Ğ˜Ğ³Ñ€Ğ°</button>
  <button onclick="show('shop')">ğŸ›’</button>
  <button onclick="show('cards')">ğŸƒ</button>
  <button onclick="show('nft')">ğŸ–¼</button>
  <button onclick="show('airdrop')">ğŸ</button>
  <button onclick="show('ref')">ğŸ”—</button>
</div>

<script>
/* ---------- ĞšĞ Ğ«Ğ¡Ğ« (Ğ‘Ğ•Ğ¡ĞšĞĞĞ•Ğ§ĞĞ) ---------- */
const RAT_IMAGES=[
 "https://i.imgur.com/2yaf2wb.png",
 "https://i.imgur.com/6X6Jv6s.png",
 "https://i.imgur.com/m7YQZ9Z.png",
 "https://i.imgur.com/p3xx6Gr.png"
];

/* ---------- Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• ---------- */
let state = JSON.parse(localStorage.getItem("ratatok_full")) || {
 coins:0,
 energy:100,
 level:1,
 taps:0,
 tapPower:1,
 auto:0,
 cards:{},
 nfts:[],
 last:Date.now(),
 refUsed:false
};

function save(){
 localStorage.setItem("ratatok_full",JSON.stringify(state));
}

/* ---------- UI ---------- */
const coinsEl=coins,energyEl=energy,levelEl=level,ratBtn=document.getElementById("ratBtn");

function currentRat(){
 return RAT_IMAGES[Math.floor(state.level/3)%RAT_IMAGES.length];
}

function update(){
 coinsEl.textContent=state.coins;
 energyEl.textContent=Math.floor(state.energy);
 levelEl.textContent=state.level;
 ratBtn.style.backgroundImage=`url(${currentRat()})`;
 save();
}

/* ---------- Ğ¢ĞĞŸ ---------- */
ratBtn.onclick=()=>{
 if(state.energy<1) return;
 state.energy--;
 state.coins+=state.tapPower;
 state.taps++;
 if(state.taps>=state.level*500){
   state.level++;
   if(state.level%5===0) state.nfts.push(state.level);
 }
 update();
};

/* ---------- Ğ­ĞĞ•Ğ Ğ“Ğ˜Ğ¯ ---------- */
setInterval(()=>{
 if(state.energy<100){
   state.energy+=0.5;
   update();
 }
},1000);

/* ---------- ĞĞ’Ğ¢ĞĞšĞ›Ğ˜Ğš ---------- */
setInterval(()=>{
 if(state.auto>0){
   state.coins+=state.auto;
   update();
 }
},1000);

/* ---------- ĞœĞĞ“ĞĞ—Ğ˜Ğ ---------- */
const SHOP=[
 {id:1,name:"+50 ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸",price:200,energy:50},
 {id:2,name:"ĞĞ²Ñ‚Ğ¾ĞºĞ»Ğ¸Ğº +1/ÑĞµĞº",price:600,auto:1}
];

function renderShop(){
 shopItems.innerHTML="";
 SHOP.forEach(i=>{
  shopItems.innerHTML+=`
   <div class="card">
    ${i.name}<br>${i.price} ğŸ’°
    <button ${state.coins<i.price?"disabled":""}
      onclick="buyShop(${i.id})">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
   </div>`;
 });
}

function buyShop(id){
 const i=SHOP.find(x=>x.id===id);
 if(state.coins<i.price) return;
 state.coins-=i.price;
 if(i.energy) state.energy+=i.energy;
 if(i.auto) state.auto+=i.auto;
 update();renderShop();
}

/* ---------- ĞšĞĞ Ğ¢ĞĞ§ĞšĞ˜ ---------- */
const CARDS=[
 {id:1,name:"+1 Ğ·Ğ° Ñ‚Ğ°Ğ¿",price:150,tap:1},
 {id:2,name:"+3 Ğ·Ğ° Ñ‚Ğ°Ğ¿",price:500,tap:3},
 {id:3,name:"+10 Ğ·Ğ° Ñ‚Ğ°Ğ¿",price:2000,tap:10}
];

function renderCards(){
 cardItems.innerHTML="";
 CARDS.forEach(c=>{
  const lvl=state.cards[c.id]||0;
  const price=c.price*(lvl+1);
  cardItems.innerHTML+=`
   <div class="card">
    ${c.name} (ÑƒÑ€ ${lvl})<br>${price} ğŸ’°
    <button ${state.coins<price?"disabled":""}
     onclick="buyCard(${c.id})">ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ</button>
   </div>`;
 });
}

function buyCard(id){
 const c=CARDS.find(x=>x.id===id);
 const lvl=state.cards[id]||0;
 const price=c.price*(lvl+1);
 if(state.coins<price) return;
 state.coins-=price;
 state.cards[id]=lvl+1;
 state.tapPower+=c.tap;
 update();renderCards();
}

/* ---------- NFT (DEMO) ---------- */
function renderNFT(){
 nftItems.innerHTML="";
 state.nfts.forEach(n=>{
  nftItems.innerHTML+=`
   <div class="card">NFT ĞºÑ€Ñ‹ÑĞ° â€¢ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ ${n}</div>`;
 });
}

/* ---------- ĞĞ˜Ğ Ğ”Ğ ĞĞŸ ---------- */
function claimAirdrop(){
 state.coins+=500;
 update();
 alert("ĞĞ¸Ñ€Ğ´Ñ€Ğ¾Ğ¿ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½ (DEMO)");
}

/* ---------- Ğ Ğ•Ğ¤Ğ•Ğ ĞĞ› ---------- */
let ref=localStorage.getItem("ratatok_ref");
if(!ref){
 ref=Math.random().toString(36).slice(2,8);
 localStorage.setItem("ratatok_ref",ref);
}
refLink.textContent=location.origin+location.pathname+"?ref="+ref;

const q=new URLSearchParams(location.search);
if(q.get("ref")&&!state.refUsed){
 state.coins+=300;
 state.refUsed=true;
}

/* ---------- ĞŸĞĞĞ•Ğ›Ğ˜ ---------- */
function show(id){hide();document.getElementById(id).style.display="block"}
function hide(){document.querySelectorAll(".panel").forEach(p=>p.style.display="none")}

/* ---------- INIT ---------- */
renderShop();renderCards();renderNFT();update();
</script>

</body>
</html>
