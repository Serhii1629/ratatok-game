<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RATATOK</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  background:#0e0e0e;
  color:#fff;
  font-family:Arial;
  margin:0;
  padding:16px;
  text-align:center;
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.card{
  background:#1b1b1b;
  border-radius:18px;
  padding:14px;
  margin:10px 0;
}
#rat{
  font-size:64px;
  margin:10px 0;
}
#tapBtn{
  font-size:42px;
  padding:30px;
  border-radius:22px;
  border:none;
  background:gold;
}
.shop button{
  width:100%;
  margin:6px 0;
  padding:14px;
  border-radius:14px;
  border:none;
  background:#333;
  color:white;
}
.plus{
  position:absolute;
  color:gold;
  font-size:24px;
  animation:fly 1s ease-out forwards;
  pointer-events:none;
}
@keyframes fly{
  from{opacity:1;transform:translateY(0)}
  to{opacity:0;transform:translateY(-60px)}
}
</style>
</head>
<body>

<div class="header">
  <div id="levelText"></div>
  <div id="langText"></div>
</div>

<div id="rat">üê≠</div>

<div class="card">
  <p id="coinsText"></p>
  <p id="energyText"></p>
  <p id="tapText"></p>
  <p id="autoText"></p>
</div>

<button id="tapBtn">TAP</button>

<div class="card shop">
  <h3 id="shopTitle"></h3>
  <button id="upTap"></button>
  <button id="upAuto"></button>
  <button id="upEnergy"></button>
</div>

<script>
// ===== LANGUAGE =====
const tgLang = window.Telegram?.WebApp?.initDataUnsafe?.user?.language_code || "en";
const L = {
  en:{
    level:l=>`‚≠ê Level ${l}`,
    coins:c=>`üí∞ Coins: ${c}`,
    energy:(e,m)=>`‚ö° Energy: ${e}/${m}`,
    tap:t=>`üëÜ Tap: +${t}`,
    auto:a=>`ü§ñ Auto: ${a}/sec`,
    shop:"üõí Shop",
    upTap:p=>`‚ûï Tap power (${p})`,
    upAuto:p=>`ü§ñ Auto income (${p})`,
    upEnergy:p=>`‚ö° Max energy (${p})`
  },
  ru:{
    level:l=>`‚≠ê –£—Ä–æ–≤–µ–Ω—å ${l}`,
    coins:c=>`üí∞ –ú–æ–Ω–µ—Ç—ã: ${c}`,
    energy:(e,m)=>`‚ö° –≠–Ω–µ—Ä–≥–∏—è: ${e}/${m}`,
    tap:t=>`üëÜ –¢–∞–ø: +${t}`,
    auto:a=>`ü§ñ –ê–≤—Ç–æ–¥–æ—Ö–æ–¥: ${a}/—Å–µ–∫`,
    shop:"üõí –ú–∞–≥–∞–∑–∏–Ω",
    upTap:p=>`‚ûï –°–∏–ª–∞ —Ç–∞–ø–∞ (${p})`,
    upAuto:p=>`ü§ñ –ê–≤—Ç–æ–¥–æ—Ö–æ–¥ (${p})`,
    upEnergy:p=>`‚ö° –ú–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏—è (${p})`
  }
};
const T = L[tgLang.startsWith("ru")?"ru":"en"];

// ===== RATS BY LEVEL =====
const rats=[
  {lvl:1,emoji:"üê≠"},
  {lvl:5,emoji:"üêÄ"},
  {lvl:10,emoji:"üêÅ"},
  {lvl:20,emoji:"üêπ"},
  {lvl:50,emoji:"üëëüêÄ"}
];

// ===== LOAD =====
let coins=+localStorage.getItem("coins")||0;
let tap=+localStorage.getItem("tap")||1;
let auto=+localStorage.getItem("auto")||0;
let energy=+localStorage.getItem("energy")||100;
let maxEnergy=+localStorage.getItem("maxEnergy")||100;
let level=+localStorage.getItem("level")||1;
let xp=+localStorage.getItem("xp")||0;

let pTap=+localStorage.getItem("pTap")||10;
let pAuto=+localStorage.getItem("pAuto")||25;
let pEnergy=+localStorage.getItem("pEnergy")||50;

// ===== UI =====
const $=id=>document.getElementById(id);
function xpNeed(){return level*100}
function currentRat(){
  return rats.filter(r=>level>=r.lvl).slice(-1)[0].emoji;
}
function update(){
  $("rat").textContent=currentRat();
  $("levelText").textContent=T.level(level);
  $("coinsText").textContent=T.coins(coins);
  $("energyText").textContent=T.energy(energy,maxEnergy);
  $("tapText").textContent=T.tap(tap);
  $("autoText").textContent=T.auto(auto);
  $("shopTitle").textContent=T.shop;
  $("upTap").textContent=T.upTap(pTap);
  $("upAuto").textContent=T.upAuto(pAuto);
  $("upEnergy").textContent=T.upEnergy(pEnergy);
}
update();

// ===== SAVE =====
function save(){
  localStorage.setItem("coins",coins);
  localStorage.setItem("tap",tap);
  localStorage.setItem("auto",auto);
  localStorage.setItem("energy",energy);
  localStorage.setItem("maxEnergy",maxEnergy);
  localStorage.setItem("level",level);
  localStorage.setItem("xp",xp);
  localStorage.setItem("pTap",pTap);
  localStorage.setItem("pAuto",pAuto);
  localStorage.setItem("pEnergy",pEnergy);
}

// ===== TAP =====
$("tapBtn").onclick=()=>{
  if(energy<=0)return;
  energy--;
  coins+=tap;
  xp+=tap;
  if(xp>=xpNeed()){xp=0;level++}
  save();update();
};

// ===== SHOP =====
$("upTap").onclick=()=>{
  if(coins<pTap)return;
  coins-=pTap;tap++;pTap=Math.floor(pTap*1.6);
  save();update();
};
$("upAuto").onclick=()=>{
  if(coins<pAuto)return;
  coins-=pAuto;auto++;pAuto=Math.floor(pAuto*1.7);
  save();update();
};
$("upEnergy").onclick=()=>{
  if(coins<pEnergy)return;
  coins-=pEnergy;maxEnergy+=10;pEnergy=Math.floor(pEnergy*1.8);
  save();update();
};

// ===== TIMERS =====
setInterval(()=>{ if(energy<maxEnergy){energy++;save();update()} },2000);
setInterval(()=>{ if(auto>0){coins+=auto;save();update()} },1000);
</script>

</body>
</html>
